{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  class: \"generate-container\"\n};\nconst _hoisted_2 = {\n  class: \"task-id\"\n};\nconst _hoisted_3 = [\"value\"];\nconst _hoisted_4 = {\n  class: \"status-message\"\n};\nconst _hoisted_5 = [\"href\", \"download\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"p\", _hoisted_2, \"Task ID: \" + _toDisplayString($data.taskId), 1 /* TEXT */), _createElementVNode(\"progress\", {\n    value: $data.progress,\n    max: \"100\",\n    class: \"progress-bar\"\n  }, null, 8 /* PROPS */, _hoisted_3), _createElementVNode(\"p\", _hoisted_4, _toDisplayString($data.statusMessage), 1 /* TEXT */), $data.downloadLink ? (_openBlock(), _createElementBlock(\"a\", {\n    key: 0,\n    href: $data.downloadLink,\n    download: $data.filename,\n    class: \"download-link\"\n  }, \"Download PPTX\", 8 /* PROPS */, _hoisted_5)) : _createCommentVNode(\"v-if\", true), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.feedback = $event),\n    placeholder: \"Enter your feedback with contact information\",\n    class: \"feedback-input\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.feedback]]), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.submitFeedback && $options.submitFeedback(...args)),\n    class: \"feedback-button\"\n  }, \"Submit Feedback\"), _createElementVNode(\"button\", {\n    class: \"back-button\",\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.goBack && $options.goBack(...args))\n  }, \"Back\")]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_toDisplayString","$data","taskId","value","progress","max","_hoisted_4","statusMessage","downloadLink","href","download","filename","_hoisted_5","feedback","$event","placeholder","onClick","_cache","args","$options","submitFeedback","goBack"],"sources":["C:\\Users\\saine\\OneDrive\\Documents\\PresentAgent\\presentagent\\src\\components\\Generate.vue"],"sourcesContent":["<template>\r\n  <div class=\"generate-container\">\r\n    <p class=\"task-id\">Task ID: {{ taskId }}</p>\r\n    <progress :value=\"progress\" max=\"100\" class=\"progress-bar\"></progress>\r\n    <p class=\"status-message\">{{ statusMessage }}</p>\r\n    <a v-if=\"downloadLink\" :href=\"downloadLink\" :download=\"filename\" class=\"download-link\">Download PPTX</a>\r\n    <input v-model=\"feedback\" placeholder=\"Enter your feedback with contact information\" class=\"feedback-input\" />\r\n    <button @click=\"submitFeedback\" class=\"feedback-button\">Submit Feedback</button>\r\n    <button class=\"back-button\" @click=\"goBack\">Back</button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'GenerateComponent',\r\n  data() {\r\n    return {\r\n      progress: 0,\r\n      statusMessage: 'Starting...',\r\n      downloadLink: '',\r\n      taskId: history.state.taskId,\r\n      feedback: '',\r\n      filename: 'final.pptx',\r\n      socket: null,\r\n    }\r\n  },\r\n  created() {\r\n    this.startGeneration()\r\n  },\r\n  beforeUnmount() {\r\n    this.closeSocket()\r\n  },\r\n  methods: {\r\n    goBack() {\r\n      this.$router.push('/')\r\n    },\r\n    async startGeneration() {\r\n      console.log(\"Connecting to websocket\", `/wsapi/${this.taskId}`)\r\n      this.socket = new WebSocket(`/wsapi/${this.taskId}`)\r\n\r\n      this.socket.onmessage = (event) => {\r\n        console.log(\"Socket Received message:\", event.data)\r\n        const data = JSON.parse(event.data)\r\n        this.progress = data.progress\r\n        this.statusMessage = data.status\r\n        if (data.progress >= 100) {\r\n          this.closeSocket()\r\n          this.fetchDownloadLink()\r\n        }\r\n      }\r\n      this.socket.onerror = (error) => {\r\n        console.error(\"WebSocket error:\", error)\r\n        this.statusMessage = 'WebSocket connection failed.'\r\n        this.closeSocket()\r\n      }\r\n    },\r\n    async fetchDownloadLink() {\r\n      try {\r\n        const downloadResponse = await this.$axios.get('/api/download', { params: { task_id: this.taskId }, responseType: 'blob' })\r\n        this.downloadLink = URL.createObjectURL(downloadResponse.data)\r\n        this.filename = \"ppagent_\" + this.taskId.replace('/', '_') + '.pptx'\r\n      } catch (error) {\r\n        console.error(\"Download error:\", error)\r\n        this.statusMessage += '\\nFailed to continue the task.'\r\n      }\r\n    },\r\n    async submitFeedback() {\r\n      if (!this.feedback) {\r\n        alert('Please enter your feedback with contact information.')\r\n        return\r\n      }\r\n      try {\r\n        await this.$axios.post('/api/feedback', { feedback: this.feedback, task_id: this.taskId })\r\n        this.statusMessage = 'Feedback submitted successfully.'\r\n        this.feedback = ''\r\n      } catch (error) {\r\n        console.error(\"Feedback submission error:\", error)\r\n        this.statusMessage = 'Failed to submit feedback.'\r\n      }\r\n    },\r\n    closeSocket() {\r\n      if (this.socket) {\r\n        this.socket.close()\r\n        this.socket = null\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.generate-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding: 20px;\r\n}\r\n\r\n.progress-bar {\r\n  width: 100%;\r\n  height: 20px;\r\n  margin-bottom: 10px;\r\n  appearance: none;\r\n  background-color: #f3f3f3;\r\n}\r\n\r\n.task-id {\r\n  font-size: 1.2em;\r\n  margin-bottom: 10px;\r\n  color: #df8638;\r\n}\r\n\r\n.progress-bar::-webkit-progress-bar {\r\n  background-color: #f3f3f3;\r\n}\r\n\r\n.progress-bar::-webkit-progress-value {\r\n  background-color: #42b983;\r\n}\r\n\r\n.status-message {\r\n  font-size: 1.2em;\r\n  margin-bottom: 10px;\r\n  color: #333;\r\n}\r\n\r\n.download-link {\r\n  font-size: 1em;\r\n  color: #42b983;\r\n  text-decoration: none;\r\n  border: 1px solid #42b983;\r\n  padding: 8px 16px;\r\n  border-radius: 4px;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.download-link:hover {\r\n  background-color: #42b983;\r\n  color: #fff;\r\n}\r\n\r\n.feedback-input {\r\n  margin-top: 10px;\r\n  padding: 8px;\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.feedback-button {\r\n  margin-top: 10px;\r\n  padding: 8px 16px;\r\n  background-color: #42b983;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n.feedback-button:hover {\r\n  background-color: #369b72;\r\n}\r\n\r\n\r\n.back-button {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  transform: translateY(10px);\r\n  background: #95a5a6;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 8px;\r\n  padding: 10px 24px;\r\n  font-size: 18px;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  box-shadow: 0 2px 6px rgba(0,0,0,0.15);\r\n  transition: background-color 0.3s, transform 0.2s;\r\n}\r\n\r\n\r\n.back-button:hover {\r\n  background: #7f8c8d;\r\n  transform: translateY(10px) scale(1.05);\r\n}\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAoB;;EAC1BA,KAAK,EAAC;AAAS;;;EAEfA,KAAK,EAAC;AAAgB;;;uBAH3BC,mBAAA,CAQM,OARNC,UAQM,GAPJC,mBAAA,CAA4C,KAA5CC,UAA4C,EAAzB,WAAS,GAAAC,gBAAA,CAAGC,KAAA,CAAAC,MAAM,kBACrCJ,mBAAA,CAAsE;IAA3DK,KAAK,EAAEF,KAAA,CAAAG,QAAQ;IAAEC,GAAG,EAAC,KAAK;IAACV,KAAK,EAAC;uCAC5CG,mBAAA,CAAiD,KAAjDQ,UAAiD,EAAAN,gBAAA,CAApBC,KAAA,CAAAM,aAAa,kBACjCN,KAAA,CAAAO,YAAY,I,cAArBZ,mBAAA,CAAwG;;IAAhFa,IAAI,EAAER,KAAA,CAAAO,YAAY;IAAGE,QAAQ,EAAET,KAAA,CAAAU,QAAQ;IAAEhB,KAAK,EAAC;KAAgB,eAAa,iBAAAiB,UAAA,K,mDACpGd,mBAAA,CAA8G;+DAA9FG,KAAA,CAAAY,QAAQ,GAAAC,MAAA;IAAEC,WAAW,EAAC,8CAA8C;IAACpB,KAAK,EAAC;iDAA3EM,KAAA,CAAAY,QAAQ,E,GACxBf,mBAAA,CAAgF;IAAvEkB,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAC,cAAA,IAAAD,QAAA,CAAAC,cAAA,IAAAF,IAAA,CAAc;IAAEvB,KAAK,EAAC;KAAkB,iBAAe,GACvEG,mBAAA,CAAyD;IAAjDH,KAAK,EAAC,aAAa;IAAEqB,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAE,MAAA,IAAAF,QAAA,CAAAE,MAAA,IAAAH,IAAA,CAAM;KAAE,MAAI,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}