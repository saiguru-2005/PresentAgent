{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/esnext.json.parse.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nexport default {\n  name: 'GenerateComponent',\n  data() {\n    return {\n      progress: 0,\n      statusMessage: 'Starting...',\n      downloadLink: '',\n      taskId: history.state.taskId,\n      feedback: '',\n      filename: 'final.pptx',\n      socket: null\n    };\n  },\n  created() {\n    this.startGeneration();\n  },\n  beforeUnmount() {\n    this.closeSocket();\n  },\n  methods: {\n    goBack() {\n      this.$router.push('/');\n    },\n    async startGeneration() {\n      console.log(\"Connecting to websocket\", `/wsapi/${this.taskId}`);\n      this.socket = new WebSocket(`/wsapi/${this.taskId}`);\n      this.socket.onmessage = event => {\n        console.log(\"Socket Received message:\", event.data);\n        const data = JSON.parse(event.data);\n        this.progress = data.progress;\n        this.statusMessage = data.status;\n        if (data.progress >= 100) {\n          this.closeSocket();\n          this.fetchDownloadLink();\n        }\n      };\n      this.socket.onerror = error => {\n        console.error(\"WebSocket error:\", error);\n        this.statusMessage = 'WebSocket connection failed.';\n        this.closeSocket();\n      };\n    },\n    async fetchDownloadLink() {\n      try {\n        const downloadResponse = await this.$axios.get('/api/download', {\n          params: {\n            task_id: this.taskId\n          },\n          responseType: 'blob'\n        });\n        this.downloadLink = URL.createObjectURL(downloadResponse.data);\n        this.filename = \"ppagent_\" + this.taskId.replace('/', '_') + '.pptx';\n      } catch (error) {\n        console.error(\"Download error:\", error);\n        this.statusMessage += '\\nFailed to continue the task.';\n      }\n    },\n    async submitFeedback() {\n      if (!this.feedback) {\n        alert('Please enter your feedback with contact information.');\n        return;\n      }\n      try {\n        await this.$axios.post('/api/feedback', {\n          feedback: this.feedback,\n          task_id: this.taskId\n        });\n        this.statusMessage = 'Feedback submitted successfully.';\n        this.feedback = '';\n      } catch (error) {\n        console.error(\"Feedback submission error:\", error);\n        this.statusMessage = 'Failed to submit feedback.';\n      }\n    },\n    closeSocket() {\n      if (this.socket) {\n        this.socket.close();\n        this.socket = null;\n      }\n    }\n  }\n};","map":{"version":3,"names":["name","data","progress","statusMessage","downloadLink","taskId","history","state","feedback","filename","socket","created","startGeneration","beforeUnmount","closeSocket","methods","goBack","$router","push","console","log","WebSocket","onmessage","event","JSON","parse","status","fetchDownloadLink","onerror","error","downloadResponse","$axios","get","params","task_id","responseType","URL","createObjectURL","replace","submitFeedback","alert","post","close"],"sources":["C:\\Users\\saine\\OneDrive\\Documents\\PresentAgent\\presentagent\\src\\components\\Generate.vue"],"sourcesContent":["<template>\r\n  <div class=\"generate-container\">\r\n    <p class=\"task-id\">Task ID: {{ taskId }}</p>\r\n    <progress :value=\"progress\" max=\"100\" class=\"progress-bar\"></progress>\r\n    <p class=\"status-message\">{{ statusMessage }}</p>\r\n    <a v-if=\"downloadLink\" :href=\"downloadLink\" :download=\"filename\" class=\"download-link\">Download PPTX</a>\r\n    <input v-model=\"feedback\" placeholder=\"Enter your feedback with contact information\" class=\"feedback-input\" />\r\n    <button @click=\"submitFeedback\" class=\"feedback-button\">Submit Feedback</button>\r\n    <button class=\"back-button\" @click=\"goBack\">Back</button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'GenerateComponent',\r\n  data() {\r\n    return {\r\n      progress: 0,\r\n      statusMessage: 'Starting...',\r\n      downloadLink: '',\r\n      taskId: history.state.taskId,\r\n      feedback: '',\r\n      filename: 'final.pptx',\r\n      socket: null,\r\n    }\r\n  },\r\n  created() {\r\n    this.startGeneration()\r\n  },\r\n  beforeUnmount() {\r\n    this.closeSocket()\r\n  },\r\n  methods: {\r\n    goBack() {\r\n      this.$router.push('/')\r\n    },\r\n    async startGeneration() {\r\n      console.log(\"Connecting to websocket\", `/wsapi/${this.taskId}`)\r\n      this.socket = new WebSocket(`/wsapi/${this.taskId}`)\r\n\r\n      this.socket.onmessage = (event) => {\r\n        console.log(\"Socket Received message:\", event.data)\r\n        const data = JSON.parse(event.data)\r\n        this.progress = data.progress\r\n        this.statusMessage = data.status\r\n        if (data.progress >= 100) {\r\n          this.closeSocket()\r\n          this.fetchDownloadLink()\r\n        }\r\n      }\r\n      this.socket.onerror = (error) => {\r\n        console.error(\"WebSocket error:\", error)\r\n        this.statusMessage = 'WebSocket connection failed.'\r\n        this.closeSocket()\r\n      }\r\n    },\r\n    async fetchDownloadLink() {\r\n      try {\r\n        const downloadResponse = await this.$axios.get('/api/download', { params: { task_id: this.taskId }, responseType: 'blob' })\r\n        this.downloadLink = URL.createObjectURL(downloadResponse.data)\r\n        this.filename = \"ppagent_\" + this.taskId.replace('/', '_') + '.pptx'\r\n      } catch (error) {\r\n        console.error(\"Download error:\", error)\r\n        this.statusMessage += '\\nFailed to continue the task.'\r\n      }\r\n    },\r\n    async submitFeedback() {\r\n      if (!this.feedback) {\r\n        alert('Please enter your feedback with contact information.')\r\n        return\r\n      }\r\n      try {\r\n        await this.$axios.post('/api/feedback', { feedback: this.feedback, task_id: this.taskId })\r\n        this.statusMessage = 'Feedback submitted successfully.'\r\n        this.feedback = ''\r\n      } catch (error) {\r\n        console.error(\"Feedback submission error:\", error)\r\n        this.statusMessage = 'Failed to submit feedback.'\r\n      }\r\n    },\r\n    closeSocket() {\r\n      if (this.socket) {\r\n        this.socket.close()\r\n        this.socket = null\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.generate-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  padding: 20px;\r\n}\r\n\r\n.progress-bar {\r\n  width: 100%;\r\n  height: 20px;\r\n  margin-bottom: 10px;\r\n  appearance: none;\r\n  background-color: #f3f3f3;\r\n}\r\n\r\n.task-id {\r\n  font-size: 1.2em;\r\n  margin-bottom: 10px;\r\n  color: #df8638;\r\n}\r\n\r\n.progress-bar::-webkit-progress-bar {\r\n  background-color: #f3f3f3;\r\n}\r\n\r\n.progress-bar::-webkit-progress-value {\r\n  background-color: #42b983;\r\n}\r\n\r\n.status-message {\r\n  font-size: 1.2em;\r\n  margin-bottom: 10px;\r\n  color: #333;\r\n}\r\n\r\n.download-link {\r\n  font-size: 1em;\r\n  color: #42b983;\r\n  text-decoration: none;\r\n  border: 1px solid #42b983;\r\n  padding: 8px 16px;\r\n  border-radius: 4px;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.download-link:hover {\r\n  background-color: #42b983;\r\n  color: #fff;\r\n}\r\n\r\n.feedback-input {\r\n  margin-top: 10px;\r\n  padding: 8px;\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.feedback-button {\r\n  margin-top: 10px;\r\n  padding: 8px 16px;\r\n  background-color: #42b983;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n.feedback-button:hover {\r\n  background-color: #369b72;\r\n}\r\n\r\n\r\n.back-button {\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  transform: translateY(10px);\r\n  background: #95a5a6;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 8px;\r\n  padding: 10px 24px;\r\n  font-size: 18px;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  box-shadow: 0 2px 6px rgba(0,0,0,0.15);\r\n  transition: background-color 0.3s, transform 0.2s;\r\n}\r\n\r\n\r\n.back-button:hover {\r\n  background: #7f8c8d;\r\n  transform: translateY(10px) scale(1.05);\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}